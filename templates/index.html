<!DOCTYPE html>
<html>
<head>
<title>Dashboard</title>
<style>
body{
    margin:0;
    font-family:Segoe UI;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    color:white;
}
.container{width:90%;margin:auto;padding:20px;}
.dashboard-row{display:flex;gap:20px;margin-bottom:30px;flex-wrap:wrap;}
.dashboard-box{
    flex:1;
    min-width:150px;
    background:rgba(255,255,255,0.1);
    padding:20px;
    border-radius:12px;
    text-align:center;
}
button{
    cursor:pointer;
    border:none;
    border-radius:6px;
    padding:6px 12px;
}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th,td{
    padding:10px;
    text-align:center;
}
th{background:rgba(255,255,255,0.2);}
td{background:rgba(255,255,255,0.05);}
.low{color:#ff4d4d;font-weight:bold;}
.alert{
    background:#ff4d4d;
    padding:10px;
    border-radius:8px;
    margin-bottom:15px;
}
</style>
</head>
<body>
<div class="container">

<h2>Welcome, {{ user }}</h2>

<a href="/sales"><button style="background:#00c896;color:white;">Sales History</button></a>
<a href="/logout"><button style="background:#ff4d4d;color:white;">Logout</button></a>

<div class="dashboard-row">
    <div class="dashboard-box">
        <h4>Total Products</h4>
        <p>{{ total_products }}</p>
    </div>
    <div class="dashboard-box">
        <h4>Total Stock</h4>
        <p>{{ total_stock }}</p>
    </div>
    <div class="dashboard-box">
        <h4>Inventory Value</h4>
        <p>₹{{ total_value }}</p>
    </div>
    <div class="dashboard-box">
        <h4>Today's Revenue</h4>
        <p>₹{{ today_sales }}</p>
    </div>
    <div class="dashboard-box">
        <h4>Transactions</h4>
        <p>{{ total_transactions }}</p>
    </div>
    <div class="dashboard-box">
        <h4>Low Stock Items</h4>
        <p class="low">{{ low_stock_count }}</p>
    </div>
</div>

{% if low_stock_count > 0 %}
<div class="alert">
⚠ Warning: You have {{ low_stock_count }} low stock items!
</div>
{% endif %}

<form action="/reset_today" method="POST">
<button style="background:#ff4d4d;color:white;">Reset Today's Sales</button>
</form>

<h3>Add Product</h3>
<form action="/add" method="POST">
<input type="text" name="name" placeholder="Product Name" required>
<input type="number" name="price" placeholder="Price" required>
<input type="number" name="quantity" placeholder="Quantity" required>
<button style="background:#00c896;color:white;">Add</button>
</form>

<h3>Inventory</h3>
<table>
<tr>
<th>ID</th>
<th>Name</th>
<th>Price</th>
<th>Qty</th>
<th>Sell</th>
</tr>

{% for p in products %}
<tr>
<td>{{ p[0] }}</td>
<td>{{ p[1] }}</td>
<td>₹{{ p[2] }}</td>
<td>
    {% if p[3] <= 5 %}
        <span class="low">{{ p[3] }} ⚠ Low</span>
    {% else %}
        {{ p[3] }}
    {% endif %}
</td>
<td>
<form action="/sell/{{ p[0] }}" method="POST">
<input type="number" name="sell_quantity" required>
<button style="background:#00c896;color:white;">Sell</button>
</form>
</td>
</tr>
{% endfor %}
</table>

</div>
</body>
</h